specVersion: 1.3.0
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum
    name: LeverageManager
    network: base
    source:
      address: "0xE594C57812a2f9fF9C2581E0Ca8fcBAEf0451793"
      abi: LeverageManager
      startBlock: 30530940
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - DefaultManagementFeeAtCreationSet
        - LeverageManagerInitialized
        - LeverageTokenActionFeeSet
        - LeverageTokenCreated
        - ManagementFeeCharged
        - ManagementFeeSet
        - Mint
        - Rebalance
        - Redeem
        - RoleAdminChanged
        - RoleGranted
        - RoleRevoked
        - TreasuryActionFeeSet
        - TreasurySet
      abis:
        - name: LeverageManager
          file: ./abis/LeverageManager.json
        - name: MorphoLendingAdapter
          file: ./abis/MorphoLendingAdapter.json
      eventHandlers:
        - event: DefaultManagementFeeAtCreationSet(uint256)
          handler: handleDefaultManagementFeeAtCreationSet
        - event: LeverageManagerInitialized(address)
          handler: handleLeverageManagerInitialized
        - event: LeverageTokenActionFeeSet(indexed address,indexed uint8,uint256)
          handler: handleLeverageTokenActionFeeSet
        - event: LeverageTokenCreated(indexed
            address,address,address,(address,address,uint256,uint256))
          handler: handleLeverageTokenCreated
        - event: ManagementFeeCharged(indexed address,uint256)
          handler: handleManagementFeeCharged
        - event: ManagementFeeSet(indexed address,uint256)
          handler: handleManagementFeeSet
        - event: Mint(indexed address,indexed
            address,(uint256,uint256,uint256,uint256,uint256,uint256))
          handler: handleMint
        - event: Rebalance(indexed address,indexed address,(uint8,uint256)[])
          handler: handleRebalance
        - event: Redeem(indexed address,indexed
            address,(uint256,uint256,uint256,uint256,uint256,uint256))
          handler: handleRedeem
        - event: RoleAdminChanged(indexed bytes32,indexed bytes32,indexed bytes32)
          handler: handleRoleAdminChanged
        - event: RoleGranted(indexed bytes32,indexed address,indexed address)
          handler: handleRoleGranted
        - event: RoleRevoked(indexed bytes32,indexed address,indexed address)
          handler: handleRoleRevoked
        - event: TreasuryActionFeeSet(indexed uint8,uint256)
          handler: handleTreasuryActionFeeSet
        - event: TreasurySet(address)
          handler: handleTreasurySet
      file: ./src/leverage-manager.ts
  - kind: ethereum
    name: LeverageTokenFactory
    network: base
    source:
      address: "0xeba55192c97CfBb5BE73Be94538b0CF9FA601CB0"
      abi: LeverageTokenFactory
      startBlock: 30530940
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities: []
      abis:
        - name: LeverageTokenFactory
          file: ./abis/LeverageTokenFactory.json
        - name: LeverageToken
          file: ./abis/LeverageToken.json
      eventHandlers:
        - event: BeaconProxyCreated(indexed address,bytes,bytes32)
          handler: handleLeverageTokenCreated
      file: ./src/leverage-token-factory.ts
  - kind: ethereum
    name: RebalanceAdapter
    network: base
    source:
      address: "0x37767d8102966577A4f5c7930e0657C592E5061b"
      abi: RebalanceAdapter
      startBlock: 30530940
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - AuctionCreated
        - AuctionEnded
        - Take
      abis:
        - name: RebalanceAdapter
          file: ./abis/RebalanceAdapter.json
      eventHandlers:
        - event: AuctionCreated((bool,uint120,uint120))
          handler: handleAuctionCreated
        - event: AuctionEnded()
          handler: handleAuctionEnded
        - event: CollateralRatiosRebalanceAdapterInitialized(uint256,uint256,uint256)
          handler: handleCollateralRatiosRebalanceAdapterInitialized
        - event: DutchAuctionRebalanceAdapterInitialized(uint256,uint256,uint256)
          handler: handleDutchAuctionRebalanceAdapterInitialized
        - event: LeverageTokenSet(address)
          handler: handleLeverageTokenSet
        - event: PreLiquidationRebalanceAdapterInitialized(uint256,uint256)
          handler: handlePreLiquidationRebalanceAdapterInitialized
        - event: RebalanceAdapterInitialized(indexed address,indexed address)
          handler: handleRebalanceAdapterInitialized
        - event: Take(indexed address,uint256,uint256)
          handler: handleTake
      file: ./src/rebalance-adapter.ts
  - kind: ethereum
    name: MorphoBlue
    network: base
    source:
      address: "0xBBBBBbbBBb9cC5e90e3b3Af64bdAF62C37EEFFCb"
      abi: MorphoBlue
      startBlock: 30530940
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - Liquidate
      abis:
        - name: MorphoBlue
          file: ./abis/MorphoBlue.json
      eventHandlers:
        - event: AccrueInterest(indexed bytes32,uint256,uint256,uint256)
          handler: handleAccrueInterest
        - event: Borrow(indexed bytes32,address,indexed address,indexed address,uint256,uint256)
          handler: handleBorrow
        - event: CreateMarket(indexed bytes32,(address,address,address,address,uint256))
          handler: handleCreateMarket
        - event: EnableIrm(indexed address)
          handler: handleEnableIrm
        - event: EnableLltv(uint256)
          handler: handleEnableLltv
        - event: FlashLoan(indexed address,indexed address,uint256)
          handler: handleFlashLoan
        - event: IncrementNonce(indexed address,indexed address,uint256)
          handler: handleIncrementNonce
        - event: Liquidate(indexed bytes32,indexed address,indexed
            address,uint256,uint256,uint256,uint256,uint256)
          handler: handleLiquidate
        - event: Repay(indexed bytes32,indexed address,indexed address,uint256,uint256)
          handler: handleRepay
        - event: SetAuthorization(indexed address,indexed address,indexed address,bool)
          handler: handleSetAuthorization
        - event: SetFee(indexed bytes32,uint256)
          handler: handleSetFee
        - event: SetFeeRecipient(indexed address)
          handler: handleSetFeeRecipient
        - event: SetOwner(indexed address)
          handler: handleSetOwner
        - event: Supply(indexed bytes32,indexed address,indexed address,uint256,uint256)
          handler: handleSupply
        - event: SupplyCollateral(indexed bytes32,indexed address,indexed address,uint256)
          handler: handleSupplyCollateral
        - event: Withdraw(indexed bytes32,address,indexed address,indexed address,uint256,uint256)
          handler: handleWithdraw
        - event: WithdrawCollateral(indexed bytes32,address,indexed address,indexed address,uint256)
          handler: handleWithdrawCollateral
      file: ./src/morpho-blue.ts

templates:
  - name: LeverageToken
    kind: ethereum/contract
    network: base
    source:
      abi: LeverageToken
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - LeverageToken
      abis:
        - name: ERC20
          file: ./abis/ERC20.json
        - name: LeverageToken
          file: ./abis/LeverageToken.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
      file: ./src/leverage-token.ts
  - name: MorphoLendingAdapter
    kind: ethereum/contract
    network: base
    source:
      abi: MorphoLendingAdapter
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities: []
      abis:
        - name: MorphoLendingAdapter
          file: ./abis/MorphoLendingAdapter.json
      file: ./src/morpho-lending-adapter.ts
